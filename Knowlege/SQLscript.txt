EXEC sp_addlinkedserver @server=''//添加linkserver 

EXEC sp_linkedserver 
[@server]='serveer'
[,[@srvproduct=]'product_name']
[,[@provider=]'provider_name']
[,[@datasrc=]'data_source']
[,[@location=]'location']
[,[@provstr=]'provider_string']
[,[@catalog=]'catalog']

if not exists
(
select *
From master.sys.servers
Where name='XXX'
)//判断XXXserver是否存在。


EXEC sp_dropserver XXX


//SQL Server 

EXEC sp_addlinkedserver
	@server = '',//server 标签
	@srvproduct='',
	@provider='SQLOLEDB',
	@datasrc='servername'
//Access

Exec sp_linkedserver
@server='',
@srvproduct='access',
@provider='Microsoft.Jet.OLEDB.4.0',
'd:"testdb"db.mdb'  //盘符：\\path\file.



//Excel

Exec sp_addlinkedserver
@server=''
@srvproduct='ex',
@provider='Microsoft.Jet.OLEDB.4.0',
@datasrc='d:...xls',
@location=null,
@provstr='Execel 5.0'


Exec sp_addlinkedserver
@server='XXx',
@srvproduct='',
@provider='SQLNCLI',
@datasrc='YYY'


//查询主键 在MS SQL 中查询主键
1. Exec sp_pkeys @table_name='xxx'
2. Select TABLE_NAME,COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_UASGE WHERE TABLE_NAME = 'XX'

//远程表变量的函数调用是不允许的。


//Job相关问题整理



//创建数据库
Create Database dbname
Primary on
(
Name=,
Filename=,
Size=,
MaxSize=,
FileGrowth=UNLIMITED
),
FileGroup FGName
(...)//结尾无逗号

on log
(...)


Alter Database dbnamea
Add filegroup fgname
Add file
(...)
to filegroup fgname



//两条语句
Select +1+1
Select 1++1

//数据库锁机制

共享锁，排它锁，意向锁
意向锁存在的原因是，在多粒度的加锁协议中减少底层粒度的遍历。
意向锁：
IS锁，给底层对象加S锁前，给高层对象加IS锁。
IX锁，给底层对象加X锁前，给高层对象加IX锁。

理论上上的加锁除了上述四种还有， S+IS，S+IX，X+IS,X+IX
上述四种组合锁 在锁强度(S+IS=S,X+IS=X,X+IX=X),只有S+IX上有新的意义。
S+IX:SIX,知在本级加共享锁，下级加排它锁。
