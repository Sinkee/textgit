EXEC sp_addlinkedserver @server=''//添加linkserver 

EXEC sp_linkedserver 
[@server]='serveer'
[,[@srvproduct=]'product_name']
[,[@provider=]'provider_name']
[,[@datasrc=]'data_source']
[,[@location=]'location']
[,[@provstr=]'provider_string']
[,[@catalog=]'catalog']

if not exists
(
select *
From master.sys.servers
Where name='XXX'
)//判断XXXserver是否存在。


EXEC sp_dropserver XXX


//SQL Server 

EXEC sp_addlinkedserver
	@server = '',//server 标签
	@srvproduct='',
	@provider='SQLOLEDB',
	@datasrc='servername'
//Access

Exec sp_linkedserver
@server='',
@srvproduct='access',
@provider='Microsoft.Jet.OLEDB.4.0',
'd:"testdb"db.mdb'  //盘符：\\path\file.



//Excel

Exec sp_addlinkedserver
@server=''
@srvproduct='ex',
@provider='Microsoft.Jet.OLEDB.4.0',
@datasrc='d:...xls',
@location=null,
@provstr='Execel 5.0'


Exec sp_addlinkedserver
@server='XXx',
@srvproduct='',
@provider='SQLNCLI',
@datasrc='YYY'


//查询主键 在MS SQL 中查询主键
1. Exec sp_pkeys @table_name='xxx'
2. Select TABLE_NAME,COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_UASGE WHERE TABLE_NAME = 'XX'
